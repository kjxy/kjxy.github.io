<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=2"><meta name=theme-color content=#222><meta name=generator content="Hexo 4.0.0"><link rel=apple-touch-icon sizes=180x180 href=/sjfw/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/sjfw/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/sjfw/images/favicon.ico><link rel=mask-icon href=/sjfw/images/logo.svg color=#222><link rel=stylesheet href=/sjfw/css/main.css><link rel=stylesheet href=/sjfw/lib/font-awesome/css/font-awesome.min.css><script id=hexo-configurations>
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://zdnyp.gitee.io/sjfw').hostname,
    root: '/sjfw/',
    scheme: 'Pisces',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script><meta name=description content="股票行情数据下载 不想写代码的话，翻到文章底部有现成的下载工具。"><meta name=keywords content=股票数据,如何下载股票的历史收盘价><meta property=og:type content=article><meta property=og:title content="如何下载股票的历史收盘价 股票历史收盘价下载方法"><meta property=og:url content=http:&#x2F;&#x2F;zdnyp.gitee.io&#x2F;sjfw&#x2F;gupiaoshujuxiazai&#x2F;ruhexiazaigupiaoshuju.html><meta property=og:site_name content=股票数据下载-数据即服务><meta property=og:description content="股票行情数据下载 不想写代码的话，翻到文章底部有现成的下载工具。"><meta property=og:locale content=zh-CN><meta property=og:image content=https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200109163701882.png?x-oss-process&#x3D;image&#x2F;watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1aWZhZ3Vhbmc&#x3D;,size_16,color_FFFFFF,t_70><meta property=og:image content=https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200109165728626.jpg><meta property=og:updated_time content=2020-01-10T02:07:40.385Z><meta name=twitter:card content=summary><meta name=twitter:image content=https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200109163701882.png?x-oss-process&#x3D;image&#x2F;watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1aWZhZ3Vhbmc&#x3D;,size_16,color_FFFFFF,t_70><link rel=canonical href=http://zdnyp.gitee.io/sjfw/gupiaoshujuxiazai/ruhexiazaigupiaoshuju.html><script id=page-configurations>
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script><title>如何下载股票的历史收盘价 股票历史收盘价下载方法 | 股票数据下载-数据即服务</title><script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7fc9fe1c22c5b520ab6a498b4fdfd7f4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><noscript><style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style></noscript></head><body itemscope><div class="container use-motion"><div class=headband></div><header class=header itemscope><div class=header-inner><div class=site-brand-container><div class=site-meta><div><a href="/sjfw/" class=brand rel=start><span class=logo-line-before><i></i></span> <span class=site-title>股票数据下载-数据即服务</span> <span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>股票行情数据下载,研究报告下载,行业报告</p></div><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div></div><nav class=site-nav><ul id=menu class=menu><li class="menu-item menu-item-home"><a href="/sjfw/" rel=section><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-股票数据"><a href="/sjfw/gupiaoshuju/" rel=section><i class="fa fa-fw fa-line-chart"></i>股票数据</a></li><li class="menu-item menu-item-行业报告"><a href="/sjfw/hangyebaogao/" rel=section><i class="fa fa-fw fa-file-archive-o"></i>行业报告</a></li><li class="menu-item menu-item-联系我们"><a href="/sjfw/about/" rel=section><i class="fa fa-fw fa-user"></i>联系我们</a></li><li class="menu-item menu-item-网站地图"><a href=/sjfw/sitemap.xml rel=section><i class="fa fa-fw fa-sitemap"></i>网站地图</a></li></ul></nav></div></header><div class=back-to-top><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class=main><div class=main-inner><div class=content-wrap><div class=content><div class=posts-expand><article itemscope" class=post-block lang=zh-CN><link itemprop=mainEntityOfPage href=http://zdnyp.gitee.io/sjfw/gupiaoshujuxiazai/ruhexiazaigupiaoshuju.html><span hidden itemprop=author itemscope><meta itemprop=image content=/sjfw/wechat.jpg><meta itemprop=name content=数据即服务><meta itemprop=description content=免费下载各类研究报告、各行业报告、研究数据；股票行情数据下载自动发送至邮箱。></span> <span hidden itemprop=publisher itemscope><meta itemprop=name content=股票数据下载-数据即服务></span><header class=post-header><h1 class=post-title itemprop="name headline">如何下载股票的历史收盘价 股票历史收盘价下载方法</h1><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-calendar-o"></i></span> <span class=post-meta-item-text>发表于</span><time title="创建时间：2020-01-10 09:57:56 / 修改时间：10:07:40" itemprop="dateCreated datePublished" datetime=2020-01-10T09:57:56+08:00>2020-01-10</time></span> <span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-folder-o"></i></span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope><a href="/sjfw/categories/gupiaoshujuxiazai/" itemprop=url rel=index><span itemprop=name>gupiaoshujuxiazai</span></a></span></span></div></header><div class=post-body itemprop=articleBody><p><strong><a href="http://www.sjfw.xyz/gupiaoshuju/" target=_blank rel=noopener title=股票行情历史数据下载>股票行情数据下载</a></strong></p><p><strong>不想写代码的话，翻到文章底部有现成的下载工具。</strong></p><a id=more></a><p>除了通过第三方接口获取股票的历史收盘价之外，我们还可以自己通过抓取的方式获取。</p><p>我们以某财经网站为例，股票的历史收盘价是这样的：<br><img src="https://img-blog.csdnimg.cn/20200109163701882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1aWZhZ3Vhbmc=,size_16,color_FFFFFF,t_70" alt=如何下载股票的历史收盘价><br>从图片上能看出，股票历史收盘价是按照年-季度的方式加载的，每年的每个季度的链接都是不一样的。</p><p>简单列一下：</p><ol><li>根据年、季度来拼接出来历史收盘价的链接。例如2020年1季度和2020年2季度的链接是不一样的，但是链接中也只有这两个数字不一样，其它都相同。</li><li>解析出每天的历史收盘价</li><li>保存到Excel或者数据库</li></ol><figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span></pre></td><td class=code><pre><span class=line>import requests,re,pandas</span></pre></td></tr><tr><td class=gutter><pre><span class=line>2</span></pre></td><td class=code><pre><span class=line></span></pre></td></tr><tr><td class=gutter><pre><span class=line>3</span></pre></td><td class=code><pre><span class=line># 这里年月都可以用datatime来实现，这里就直接写出来了。</span></pre></td></tr><tr><td class=gutter><pre><span class=line>4</span></pre></td><td class=code><pre><span class=line>year &#x3D; [2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020]</span></pre></td></tr><tr><td class=gutter><pre><span class=line>5</span></pre></td><td class=code><pre><span class=line>month &#x3D; [1,2,3,4]</span></pre></td></tr><tr><td class=gutter><pre><span class=line>6</span></pre></td><td class=code><pre><span class=line></span></pre></td></tr><tr><td class=gutter><pre><span class=line>7</span></pre></td><td class=code><pre><span class=line>base_url &#x3D; &#39;https:&#x2F;&#x2F;www.baidu.com&#x2F;&#39; # 假设要抓取的网站是百度</span></pre></td></tr><tr><td class=gutter><pre><span class=line>8</span></pre></td><td class=code><pre><span class=line></span></pre></td></tr><tr><td class=gutter><pre><span class=line>9</span></pre></td><td class=code><pre><span class=line>one_list &#x3D; []</span></pre></td></tr><tr><td class=gutter><pre><span class=line>10</span></pre></td><td class=code><pre><span class=line>arry_list &#x3D; []</span></pre></td></tr><tr><td class=gutter><pre><span class=line>11</span></pre></td><td class=code><pre><span class=line></span></pre></td></tr><tr><td class=gutter><pre><span class=line>12</span></pre></td><td class=code><pre><span class=line>for y in year:</span></pre></td></tr><tr><td class=gutter><pre><span class=line>13</span></pre></td><td class=code><pre><span class=line>	for m in month:</span></pre></td></tr><tr><td class=gutter><pre><span class=line>14</span></pre></td><td class=code><pre><span class=line>		y_m &#x3D;f&#39;&#123;y&#125;-&#123;m&#125;&#39;</span></pre></td></tr><tr><td class=gutter><pre><span class=line>15</span></pre></td><td class=code><pre><span class=line>		response &#x3D; requests.get(f&#39;&#123;base_url&#125;?&#123;y_m&#125;&#39;) # 这里获取到了2010年1季度的源码，依次循环会获取到2020年4季度。</span></pre></td></tr><tr><td class=gutter><pre><span class=line>16</span></pre></td><td class=code><pre><span class=line>		close_price &#x3D; re.findall(&#39;(\d+)&#39;,response.text) # 这里通过正则解析除了股票的历史收盘价</span></pre></td></tr><tr><td class=gutter><pre><span class=line>17</span></pre></td><td class=code><pre><span class=line>		one_list.append(close_price)</span></pre></td></tr><tr><td class=gutter><pre><span class=line>18</span></pre></td><td class=code><pre><span class=line>		arry_list.append(one_list)</span></pre></td></tr><tr><td class=gutter><pre><span class=line>19</span></pre></td><td class=code><pre><span class=line></span></pre></td></tr><tr><td class=gutter><pre><span class=line>20</span></pre></td><td class=code><pre><span class=line>df &#x3D; pandas.DataFrame(a, columns&#x3D;[&#39;open_price&#39;, &#39;close_price&#39;, &#39;vol&#39;]) </span></pre></td></tr><tr><td class=gutter><pre><span class=line>21</span></pre></td><td class=code><pre><span class=line>wt &#x3D; ExcelWriter(path) # path 是文件的保存路径，要精确到文件名</span></pre></td></tr><tr><td class=gutter><pre><span class=line>22</span></pre></td><td class=code><pre><span class=line>df.to_excel(wt, sheet_name&#x3D;&#39;如何下载股票的历史收盘价&#39; , index&#x3D;False)</span></pre></td></tr></table></figure><p>以上就可以把一个股票的历史收盘价都保存到Excel了，还是比较简单的。</p><p><strong>不想写代码的直接扫下面二维码，自助下载，没有限制条件，2秒完成。</strong><br><img src=https://img-blog.csdnimg.cn/20200109165728626.jpg alt=在这里插入图片描述></p><br><p><a href=https://www.sohu.com/a/365822779_369660 target=_blank rel=noopener>如何下载股票的历史收盘价 股票历史收盘价下载方法</a></p></div><footer class=post-footer><div class=post-tags><a href="/sjfw/tags/%E8%82%A1%E7%A5%A8%E6%95%B0%E6%8D%AE/" rel=tag># 股票数据</a> <a href="/sjfw/tags/%E5%A6%82%E4%BD%95%E4%B8%8B%E8%BD%BD%E8%82%A1%E7%A5%A8%E7%9A%84%E5%8E%86%E5%8F%B2%E6%94%B6%E7%9B%98%E4%BB%B7/" rel=tag># 如何下载股票的历史收盘价</a></div><div class=post-nav><div class=post-nav-item><a href=/sjfw/gupiaoshujuxiazai/603611gupiaohangqingshuju20200109.html rel=prev title=股票历史数据(诺力股份603611)-20200109><i class="fa fa-chevron-left"></i> 股票历史数据(诺力股份603611)-20200109</a></div><div class=post-nav-item><a href=/sjfw/gupiaoshujuxiazai/002732gupiaohangqingshuju20200110.html rel=next title=如何下载股票的历史收盘价(燕塘乳业002732)-20200110>如何下载股票的历史收盘价(燕塘乳业002732)-20200110 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=数据即服务 src=/sjfw/wechat.jpg><p class=site-author-name itemprop=name>数据即服务</p><div class=site-description itemprop=description>免费下载各类研究报告、各行业报告、研究数据；股票行情数据下载自动发送至邮箱。</div></div><div class="links-of-author motion-element"><span class=links-of-author-item><a href=/sjfw/wechat.jpg title="公众号 → wechat.jpg"><i class="fa fa-fw fa-weixin"></i>公众号</a></span></div></div></div></aside><div id=sidebar-dimmer></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; <span itemprop=copyrightYear>2020</span> <span class=with-love><i class="fa fa-user"></i></span> <span class=author itemprop=copyrightHolder>数据即服务</span></div><div class=powered-by><a href="/sjfw/" class=theme-link>数据即服务</a></div></div></footer></div><script src=/sjfw/lib/anime.min.js></script><script src=//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js></script><script src=/sjfw/lib/velocity/velocity.min.js></script><script src=/sjfw/lib/velocity/velocity.ui.min.js></script><script src=/sjfw/js/utils.js></script><script src=/sjfw/js/motion.js></script><script src=/sjfw/js/schemes/pisces.js></script><script src=/sjfw/js/next-boot.js></script></body></html>